define(["lodash","coreUtilsLib"],function(e,n){return function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=6)}([function(n,t){n.exports=e},function(e,n,t){"use strict";t.r(n),t.d(n,"isMergeVirtualGroup",function(){return a}),t.d(n,"isRescaleVirtualGroup",function(){return c}),t.d(n,"isVirtualGroup",function(){return s}),t.d(n,"isDesktopOnlyComponent",function(){return u}),t.d(n,"isTextComponent",function(){return l}),t.d(n,"isGraphicComponent",function(){return f}),t.d(n,"isGroupComponent",function(){return d}),t.d(n,"isColumnsContainerComponent",function(){return m}),t.d(n,"isImageComponent",function(){return p}),t.d(n,"isMasterPage",function(){return g}),t.d(n,"isDockingAllowed",function(){return h}),t.d(n,"isFixedPositionAllowed",function(){return y}),t.d(n,"shouldStretchToScreenWidth",function(){return v}),t.d(n,"extractComponentsFromStructureByType",function(){return C}),t.d(n,"isScreenWidthComponent",function(){return T}),t.d(n,"translateComps",function(){return E}),t.d(n,"reparentComponent",function(){return D}),t.d(n,"addComponentsTo",function(){return O}),t.d(n,"removeChildrenFrom",function(){return b}),t.d(n,"removeGroup",function(){return N}),t.d(n,"containsComponent",function(){return S}),t.d(n,"getHeightAccordingToChildren",function(){return I}),t.d(n,"ensureContainerTightlyWrapsChildren",function(){return x}),t.d(n,"isSiteSegmentOrPage",function(){return M}),t.d(n,"isPageComponent",function(){return _}),t.d(n,"isContainerComponent",function(){return P}),t.d(n,"isSiteSegment",function(){return w}),t.d(n,"isAllowedToBeInMasterPage",function(){return A}),t.d(n,"extractMobilePage",function(){return R}),t.d(n,"getComponentByIdFromStructure",function(){return k}),t.d(n,"unifyGroups",function(){return B}),t.d(n,"getComponentsByIds",function(){return L}),t.d(n,"getParent",function(){return G}),t.d(n,"getSnugLayout",function(){return F}),t.d(n,"getTinyMenuDefaultPosition",function(){return H}),t.d(n,"getChildren",function(){return j}),t.d(n,"getRangesOverlap",function(){return z}),t.d(n,"getYOverlap",function(){return W}),t.d(n,"getXOverlap",function(){return U}),t.d(n,"hasGreaterArea",function(){return V}),t.d(n,"haveSufficientOverlap",function(){return X}),t.d(n,"isEmptyContainer",function(){return q}),t.d(n,"shouldReparentCompToChildOfContainer",function(){return Q}),t.d(n,"getAllCompsInStructure",function(){return K});var o=t(0),r=t(2),i=t(4);const a=e=>o.get(e,"componentType")===r.a.VIRTUAL_GROUP_TYPES.MERGE,c=e=>o.get(e,"componentType")===r.a.VIRTUAL_GROUP_TYPES.RESCALE,s=e=>c(e)||a(e);function u(e){return o.get(e,["conversionData","desktopOnly"],!1)}function l(e){return"text"===o.get(e,["conversionData","category"])}function f(e){return"graphic"===o.get(e,["conversionData","category"])||p(e)}function d(e){return e&&"wysiwyg.viewer.components.Group"===e.componentType}function m(e){return"columns"===o.get(e,["conversionData","category"])}function p(e){return"photo"===o.get(e,["conversionData","category"])}function g(e){return"masterPage"===o.get(e,"id")}function h(e){return o.get(e,["conversionData","isDockingAllowed"])}function y(e){return o.get(e,["conversionData","isFixedPositionAllowed"])}function v(e){const n=e=>o.get(e.conversionData,"isScreenWidth",!1)||o.get(e.conversionData,"stretchHorizontally",!1)||o.some(e.components,n);return M(e)||n(e)}function C(e,n){const t=j(e),r=o.remove(t,e=>o.includes(n,e.componentType));return o.concat(r,o.flatMap(t,C))}function T(e){return o.get(e.conversionData,"isScreenWidth",!1)||o.some(e.components,T)}function E(e,n=0,t=0){o.forEach(e,e=>{e.layout.x+=n,e.layout.y+=t})}function D(e,n,t){O(e,[n],t),E([n],-e.layout.x,-e.layout.y)}function O(e,n,t){const o=j(e);n.length&&o&&(t=void 0!==t?t:o.length,o.splice.apply(o,[t,0].concat(n)))}function b(e,n){const t=j(e);o.remove(t,e=>o.includes(n,e))}function N(e,n){if(!d(e))return;const t=o.findIndex(n.components,{id:e.id});o.forEach(e.components.reverse(),o=>{O(n,[o],t),E([o],e.layout.x,e.layout.y)}),o.remove(n.components,e)}function S(e,n){return o.some(j(e),e=>n(e)||e&&S(e,n))}function I(e,n,t){if(g(e))return;if(!n||!t&&o.isEmpty(n))return;const i=o(n).reject(["conversionData.isInvisible",!0]).reduce((e,n)=>o.max([e,n.layout.y+n.layout.height,0]),0);return o.get(e,["conversionData","hasTightYMargin"])||o.get(e,["conversionData","hasTightBottomMargin"])?i:i+(v(e)?r.a.SECTION_MOBILE_MARGIN_Y:r.a.COMPONENT_MOBILE_MARGIN_Y+o.get(e.conversionData,"borderWidth",0))}function x(e,n,t,r=0){const i=I(e,n,t);if(o.isNumber(i)){const n=o.get(e,["conversionData","minHeight"],r);e.layout.height=Math.max(n,i)}}function M(e){return _(e)||w(e)}function _(e){return"Page"===e.type}function P(e){return"Container"===e.type}function w(e){return o.has(e.conversionData,"siteSegmentRole")}function A(e){return w(e)||o.has(e.conversionData,"isAllowedToBeChildOfMasterPage")}function R(e){const n=i.objectUtils.cloneDeep(e),t=o.has(n,"components")?"components":"children";return o.set(n,t,e.mobileComponents||[])}function k(e,n){if(n.id===e)return n;let t=null;return o.find(j(n),n=>t=k(e,n)),t}function B(e,n){if(e.length>n)return void(e.length=0);const t=(e,n)=>o.size(o.intersection(e,n))>0;for(let n=e.length-1;n>=0;n--){const r=o.findLastIndex(e,(o,r)=>r<n&&t(e[n],o));-1!==r&&(e[r]=e[r].concat(o.difference(e[n],e[r])),e.splice(n,1))}}function L(e,n){const t=j(e);return o.map(n,e=>o.find(t,{id:e})||null)}function G(e,n){const t=j(n);if(o.find(t,{id:e}))return n;let r=null;return o.find(t,n=>r=G(e,n)),r}function F(e){if(!e||0===e.length)return;const n=o.min(o.map(e,"layout.x")),t=o.min(o.map(e,"layout.y"));return{x:n,y:t,width:o.max(o.map(e,e=>e.layout.x+e.layout.width))-n,height:o.max(o.map(e,e=>e.layout.y+e.layout.height))-t,rotationInDegrees:0}}function H(){return{x:r.a.MOBILE_WIDTH-(r.a.TINY_MENU_SIZE+r.a.SITE_SEGMENT_PADDING_X),y:r.a.SECTION_MOBILE_MARGIN_Y,rotationInDegrees:0}}function j(e){return e.components||e.children}function z(e=[],n=[]){const t=(e,n)=>Math.min(e[1],n[1])-n[0];return e[0]<=n[0]?t(e,n):t(n,e)}function W(e,n){const t=e=>[e.layout.y,e.layout.height+e.layout.y];return z(t(e),t(n))}function U(e,n){if(T(e))return n.layout.width;if(T(n))return e.layout.width;const t=e=>[e.layout.x,e.layout.width+e.layout.x];return z(t(e),t(n))}const Y=e=>e.layout.width*e.layout.height;function V(e,n){return T(e)?e.layout.height>=n.layout.height||Y(e)>Y(n):!T(n)&&Y(e)>Y(n)}function X(e,n,t){const o=U(e,n),r=W(e,n);if(o<=0||r<=0)return!1;const i=o*r,a=Math.min(Y(e),Y(n));return i>0&&i/a>=t}function q(e){return!!P(e)&&("columns"===e.conversionData.category?1===o.size(e.components)&&o.isEmpty(e.components[0].components):o.isEmpty(e.components))}function Q(e,n){return m(n)&&o.get(e,["conversionData","isInvisible"],!1)}function K(e,n=!1,t){const r=[[e]];for(const e of r)o.forEach(e,e=>{const t=n?o.get(e,"mobileComponents"):j(e);o.isEmpty(t)||r.push(t)});return o(r).flatten().remove(t).keyBy("id").value()}},function(e,n,t){"use strict";t.d(n,"a",function(){return o});const o={MOBILE_WIDTH:320,MARGIN_BETWEEN_TEXT_AND_NON_TEXT:20,COMPONENT_MOBILE_MARGIN_X:10,COMPONENT_MOBILE_MARGIN_Y:10,SECTION_MOBILE_MARGIN_Y:20,SITE_SEGMENT_PADDING_X:20,TINY_MENU_SIZE:50,TEXT_MAX_LENGTH_FOR_RESCALING:25,MIN_WIDTH_FOR_ENLARGE:140,DEFAULT_TEXT_HEIGHT:10,VIRTUAL_GROUP_TYPES:{RESCALE:"RESCALE_VIRTUAL_GROUP",MERGE:"MERGE_VIRTUAL_GROUP"}}},function(e,n,t){"use strict";t.d(n,"e",function(){return a}),t.d(n,"c",function(){return c}),t.d(n,"b",function(){return s}),t.d(n,"a",function(){return l}),t.d(n,"d",function(){return d}),t.d(n,"g",function(){return m}),t.d(n,"h",function(){return p}),t.d(n,"f",function(){return g});var o=t(0),r=t(1);const i=.1,a=e=>0===e?0:e/Math.abs(e),c=(e,n)=>"x"===n?e.layout.width:e.layout.height,s=(e,n)=>e.layout[n]+c(e,n);function u(e,n,t,r=i){const a=o.get(e,t),c=o.get(n,t);return Math.abs(a-c)<=r*o.min([a,c])}function l(e,n,t){return e===n||o.size(e)===o.size(n)&&!f(e,t)&&!f(n,t)&&o.every(e,(e,r)=>{const a=n[r];return e.componentType===a.componentType&&function(e,n,t,r=i){const a=o.get(e,["layout",t]),s=o.get(n,["layout",t]);return Math.abs(a-s)<=r*o.min([c(e,t),c(n,t)])}(e,a,t)&&("text"===e.conversionData.category?u(e,a,["conversionData","averageNormalizedFontSize"]):u(e,a,["layout","height"])&&u(e,a,["layout","width"]))})}function f(e,n){const t=o.findIndex(e,(t,r)=>{if(0===r)return!1;const i=s(e[r-1],n),a=t.layout[n]-i;return a<0||a>o.min([c(e[r-1],n),c(t,n)])});return-1!==t&&t!==e.length-1}function d(e){const n=r.getChildren(e);return o.map(e.conversionData.componentsOrder,e=>o.find(n,{id:e}))}const m=e=>r.isRescaleVirtualGroup(e)&&"reorder"!==e.conversionData.rescaleMethod||e.conversionData.structuralContainer;function p(e,n){const t=o.map(r.getChildren(e),"id");return o.sortBy(n,e=>t.indexOf(e.id))}function g(e){const n=o.pick(e.conversionData.mobileHints,["recommendedWidth","recommendedHeight","recommendedScale","recommendedOrder"]);return!o.isEmpty(n)}},function(e,t){e.exports=n},function(e,n,t){"use strict";t.d(n,"a",function(){return h}),t.d(n,"b",function(){return y}),t.d(n,"c",function(){return S});var o=t(0),r=t(3),i=t(4);const a={START_EVENT:"start",END_EVENT:"end"},c=.9,s={HORIZONTAL:1,VERTICAL:1.25};function u(e,n){return o.transform(e,(e,t,o)=>{const r=n(o);return e[r]=e[r]||{comps:[],distanceToPreviousFragment:t.distanceToPreviousFragment},e[r].comps=[...e[r].comps,...t.comps],e},[])}const l={singleCompRow(e,n,t){if("x"===t)return null;const i=o.findIndex(e,e=>1===o.size(e.comps));if(-1===i)return null;const a=u(e,e=>Object(r.e)(e-i)+Object(r.e)(i));return{type:"singleCompRow",fragments:a,fragmentsEvents:E(n,a)}},verticalDivider(e,n,t){if(o.size(e)<3||o.every(e,e=>1===o.size(e.comps))||"y"===t)return null;const i=function(e,n){const t=o(n.y).partition({eventType:a.START_EVENT}).map(e=>o.map(e,"coordinate")).value(),i=o.max(t[0]),c=o.min(t[1]);return o.findIndex(e,e=>{const n=e.comps[0];return 1===e.comps.length&&n.conversionData.keepIfVerticalDivider&&n.layout.y<=c&&Object(r.b)(n,"y")>=i})}(e,n);if(-1===i)return null;o.set(e[i].comps[0],["conversionData","isVerticalDivider"],!0);const c=u(e,e=>Object(r.e)(e-i)+Object(r.e)(i));return{type:"verticalDivider",fragments:c,fragmentsEvents:E(n,c)}},mirrorPattern(e,n,t){if(o.size(e)<2)return null;const i=E(n,e),a=d(t),c=o.map(i,e=>f(e[a])),s=o.every(c,e=>Object(r.a)(e,c[0],a));return s&&s?p(o.flatten(c),n,{type:"mirrorPattern"}):null},chessPattern(e,n,t){if("y"!==t||o.size(e)<2||!o.every(e,e=>2===o.size(e.comps)))return null;const r=E(n,e),i=o.map(r,e=>f(e.x)),a=o.flatMap(i,(e,n)=>m(n)?e:o.reverse(e)),c=a[0].conversionData.category,s="text"===c?"photo":"text";return o.every(a,(e,n)=>e.conversionData.category===(m(n)?c:s))?p(a,n,{type:"chessPattern"}):null}},f=e=>o(e).map("compRef").uniq().value(),d=e=>"x"===e?"y":"x",m=e=>e%2==0;function p(e,n,t){return o.assign(t,{fragments:[{comps:e,distanceToPreviousFragment:-1}],fragmentsEvents:[n]})}function g(e,n){const t=o.findLastIndex(e,e=>{if(e.coordinate===n.coordinate){if(e.eventType===a.START_EVENT&&n.eventType===a.START_EVENT)return e.size>n.size;if(e.eventType===a.END_EVENT&&n.eventType===a.END_EVENT)return e.size<n.size;if(e.eventType===a.START_EVENT&&n.eventType===a.END_EVENT)return e.compRef===n.compRef;if(e.eventType===a.END_EVENT&&n.eventType===a.START_EVENT)return e.compRef!==n.compRef}return e.coordinate<n.coordinate});return e.splice(t+1,0,n),e}function h(e,n){const t=o.transform(e,(e,t)=>{const o=t.layout[n]||0,i=Object(r.b)(t,n)||o,c=Object(r.c)(t,n)||0;return g(e,{eventType:a.START_EVENT,compRef:t,coordinate:o,size:c}),g(e,{eventType:a.END_EVENT,compRef:t,coordinate:i,size:c}),e},[]);return o.map(t,e=>o.omit(e,"size"))}function y(e){const n=[],t=[];return o.forEach(e,e=>{const r=o.last(t);if(e.eventType===a.START_EVENT){if(o.isEmpty(n)){const n={events:[e],distanceToPreviousFragment:r?e.coordinate-o.last(r.events).coordinate:-1};t.push(n)}else r.events.push(e);n.push(e)}else o.remove(n,{compRef:e.compRef}),r.events.push(e)}),o.map(t,e=>({comps:f(e.events),distanceToPreviousFragment:e.distanceToPreviousFragment}))}function v(e,n,t){const r=o.maxBy(e,"distanceToPreviousFragment"),i=o.findIndex(e,r),a=u(e,e=>e<i?0:1),c=[e[i-1],r],s=o.filter(n[d(t)],e=>o.some(c,n=>o.includes(n.comps,e.compRef))),l={fragmentsEvents:E(n,a),fragments:a},f=C(c,s,t);return o.assign(l,{maxCompsDistance:f})}function C(e,n,t){const i=function(e,n){return o(e).map((e,t)=>t?o.map(e,e=>o.defaults({closestPoint:e.compRef.layout[n]},e)):o.map(e,e=>o.defaults({closestPoint:Object(r.b)(e.compRef,n)},e))).map((e,n)=>o.reduce(e,(e,t)=>{const r=o.last(e);return r&&r.eventType!==a.END_EVENT?r.compRef===t.compRef?[...e,t]:((n&&t.closestPoint<r.closestPoint||!n&&t.closestPoint>r.closestPoint)&&e.splice(e.length-1,1,t),e):e.concat(t.eventType===a.START_EVENT?[t]:[])},[])).value()}(o.partition(n,n=>o.includes(e[0].comps,n.compRef)),t),c=[0,0],s=[[],[]];let u=-1/0;for(;c[0]<i[0].length||c[1]<i[1].length;){const e=c[0]===i[0].length||c[1]===i[1].length?c[0]===i[0].length?1:0:i[0][c[0]].coordinate<=i[1][c[1]].coordinate?0:1,n=i[e][c[e]++];if(n.eventType===a.END_EVENT){o.remove(s[e],{compRef:n.compRef});continue}s[e].push(n);const t=[o.maxBy(s[0],"closestPoint"),o.minBy(s[1],"closestPoint")],r=o.get(t,[1,"closestPoint"])-o.get(t,[0,"closestPoint"]);!o.isNaN(r)&&r>u&&(u=r)}return u}function T(e,n){return o.transform(e,(e,t)=>{const r=o.findIndex(n,e=>o.includes(e.comps,t.compRef));return e[r]=[...e[r]||[],t],e},[])}function E(e,n){const t=T(e.x,n),r=T(e.y,n);return o.map(o.keys(n),e=>o.assign({},{x:t[e],y:r[e]}))}function D(e,n,t){return function(e,n,t){let r=null;return o.forEach(l,(o,i)=>{if(!t[i])return!0;const a=o(n.y,e,"y"),c=o(n.x,e,"x");return null===(r=a&&c?null:a||c)}),r}(e,n,t)||function(e,n){const t=o.size(n.x)>1?v(n.x,e,"x"):null,r=o.size(n.y)>1?v(n.y,e,"y"):null;if(t&&r){const e=s.HORIZONTAL*t.maxCompsDistance>s.VERTICAL*r.maxCompsDistance?t:r;return o.pick(e,["fragments","fragmentsEvents"])}return t||r}(e,n)}function O(e,n,t,i){if(o.size(n)<2)return n||[];const a=o.mapValues(t,y);if(1===o.size(a.x)&&1===o.size(a.y))return i.detectSemanticGroups?i.useOverlapRules?function(e,n){n=Object(r.h)(e,n);const t=`overlayGroup_${(n=o.sortBy(n,"layout.y"))[0].id}`;return o.forEach(n,e=>o.set(e,["conversionData","overlayGroupId"],t)),n}(e,n):function(e,n,t){const r=e=>o.some(e,"conversionData.originalLayout");if(r(n)||o.some(n,e=>r(e)))return N(n),n;b(n);const i=h(n,"y"),a=h(n,"x"),c=O(e,n,{y:i,x:a},t);return N(c),c}(e,n,i):Object(r.h)(e,n);const c=D(t,a,{mirrorPattern:i.detectSemanticGroups,chessPattern:i.detectSemanticGroups,verticalDivider:!0,singleCompRow:!0});return 1===o.size(c.fragments)?c.fragments[0].comps:o.flatMap(c.fragments,(n,t)=>O(e,n.comps,c.fragmentsEvents[t],i))}function b(e){o.forEach(e,e=>{const n=e.layout,t=o.assign(i.objectUtils.cloneDeep(n),{height:n.height*c,width:n.width*c});e.layout=t,o.set(e,["conversionData","originalLayout"],n)})}function N(e,n=!0){o.forEach(e,e=>{const n=o.get(e,["conversionData","originalLayout"]);n&&(e.layout=i.objectUtils.cloneDeep(n),delete e.conversionData.originalLayout)}),n&&o.forEach(e,e=>N(e.components,!1))}function S(e,n,t){const r=O(e,n,{y:h(n,"y"),x:h(n,"x")},t);e.conversionData.componentsOrder=o.map(r,"id")}r.h},function(e,n,t){"use strict";t.r(n);var o={};t.r(o),t.d(o,"getAdditionalStyles",function(){return x}),t.d(o,"addToStructure",function(){return M});var r={};t.r(r),t.d(r,"addToStructure",function(){return P});var i=t(0);const a={"adobe-caslon-w01-smbd":{referencePoints:[17,40,82],friendlyName:"Adobe Caslon"},'"amatic sc"':{referencePoints:[18,42,84],friendlyName:"Amatic SC"},"americantypwrteritcw01--731025":{referencePoints:[16,42,84],friendlyName:"American Typewriter"},anton:{referencePoints:[15,36,78],friendlyName:"Anton"},arial:{referencePoints:[15,40,82],friendlyName:"Arial"},'"arial black"':{referencePoints:[15,40,82],friendlyName:"Arial Black"},"avenida-w01":{referencePoints:[20,45,88],friendlyName:"Avenida"},"avenir-lt-w01_85-heavy1475544":{referencePoints:[15,40,82],friendlyName:"Avenir"},"avenir-lt-w01_35-light1475496":{referencePoints:[15,40,82],friendlyName:"Avenir Light"},basic:{referencePoints:[15,40,82],friendlyName:"Basic"},"belinda-w00-regular":{referencePoints:[19,44,88],friendlyName:"Belinda"},"bodoni-w01-poster":{referencePoints:[15,40,82],friendlyName:"Bodoni Poster"},"braggadocio-w01":{referencePoints:[15,36,78],friendlyName:"Braggadocio"},"brandon-grot-w01-light":{referencePoints:[18,42,86],friendlyName:"Brandon Grotesque"},"bree-w01-thin-oblique":{referencePoints:[16,40,82],friendlyName:"Bree"},caudex:{referencePoints:[16,41,84],friendlyName:"Caudex"},'"chelsea market"':{referencePoints:[15,40,82],friendlyName:"Chelsea Market"},cinzel:{referencePoints:[15,40,82],friendlyName:"Cinzel"},"clarendon-w01-medium-692107":{referencePoints:[17,44,84],friendlyName:"Clarendon LT"},'"comic sans ms"':{referencePoints:[15,40,82],friendlyName:"Comic Sans MS"},cookie:{referencePoints:[22,52,100],friendlyName:"Cookie"},"coquette-w00-light":{referencePoints:[18,44,84],friendlyName:"Coquette"},corben:{referencePoints:[16,42,82],friendlyName:"Corben"},'"courier new"':{referencePoints:[17,48,96],friendlyName:"Courier New"},"dinneuzeitgroteskltw01-_812426":{referencePoints:[15,40,82],friendlyName:"DIN Neuzeit Grotesk"},"din-next-w01-light":{referencePoints:[15,40,82],friendlyName:"DIN Next Light"},"droid-serif-w01-regular":{referencePoints:[15,40,82],friendlyName:"Droid Serif"},'"eb garamond"':{referencePoints:[18,42,84],friendlyName:"EB Garamond"},enriqueta:{referencePoints:[15,40,80],friendlyName:"Enriqueta"},forum:{referencePoints:[17,44,86],friendlyName:"Forum"},'"fredericka the great"':{referencePoints:[15,38,76],friendlyName:"Fredericka the Great"},"futura-lt-w01-book":{referencePoints:[15,38,76],friendlyName:"Futura"},"futura-lt-w01-light":{referencePoints:[15,38,76],friendlyName:"Futura Light"},georgia:{referencePoints:[15,40,80],friendlyName:"Georgia"},"geotica-w01-four-open":{referencePoints:[15,40,82],friendlyName:"Geotica Four Open"},"helvetica-w01-roman":{referencePoints:[15,40,82],friendlyName:"Helvetica"},impact:{referencePoints:[15,36,76],friendlyName:"Impact"},"itc-arecibo-w01-regular":{referencePoints:[18,44,88],friendlyName:"ITC Arecibo"},'"jockey one"':{referencePoints:[16,42,82],friendlyName:"Jockey One"},'"josefin slab"':{referencePoints:[18,42,82],friendlyName:"Josefin Slab"},jura:{referencePoints:[18,44,90],friendlyName:"Jura"},'"kelly slab"':{referencePoints:[15,38,78],friendlyName:"Kelly Slab"},"kepler-w03-light-scd-cp":{referencePoints:[18,45,85],friendlyName:"Kepler"},'"libre baskerville"':{referencePoints:[15,37,76],friendlyName:"Libre Baskerville"},"didot-w01-italic":{referencePoints:[15,40,82],friendlyName:"Linotype Didot"},lobster:{referencePoints:[17,42,82],friendlyName:"Lobster"},'"lucida console"':{referencePoints:[15,38,78],friendlyName:"Lucida Console"},'"lucida sans unicode"':{referencePoints:[15,38,78],friendlyName:"Lucida Sans Unicode"},"lulo-clean-w01-one-bold":{referencePoints:[14,36,76],friendlyName:"Lulo Clean"},'"marck script"':{referencePoints:[20,48,92],friendlyName:"Marck Script"},"marzo-w00-regular":{referencePoints:[15,40,78],friendlyName:"Marzo"},monoton:{referencePoints:[14,36,76],friendlyName:"Monoton"},"baskervillemtw01-smbdit":{referencePoints:[18,44,88],friendlyName:"Monotype Baskerville"},'"mr de haviland"':{referencePoints:[22,46,94],friendlyName:"Mr De Haviland"},"museo-w01-700":{referencePoints:[15,40,82],friendlyName:"Museo"},"museo-slab-w01-100":{referencePoints:[15,40,82],friendlyName:"Museo Slab"},niconne:{referencePoints:[20,46,90],friendlyName:"Niconne"},"nimbus-sans-tw01con":{referencePoints:[17,44,88],friendlyName:"Nimbus Sans"},'"noticia text"':{referencePoints:[15,40,82],friendlyName:"Noticia Text"},'"open sans"':{referencePoints:[15,40,82],friendlyName:"Open Sans"},'"open sans condensed"':{referencePoints:[15,40,82],friendlyName:"Open Sans Condensed"},overlock:{referencePoints:[16,42,84],friendlyName:"Overlock"},"pacifica-w00-condensed":{referencePoints:[14,36,74],friendlyName:"Pacifica Condensed"},'"palatino linotype"':{referencePoints:[16,44,86],friendlyName:"Palatino Linotype"},'"patrick hand"':{referencePoints:[17,44,86],friendlyName:"Patrick Hand"},"peaches-and-cream-regular-w00":{referencePoints:[26,54,120],friendlyName:"Peaches & Cream"},play:{referencePoints:[15,42,84],friendlyName:"Play"},'"playfair display"':{referencePoints:[15,40,82],friendlyName:"Playfair Display"},"proxima-n-w01-reg":{referencePoints:[15,41,82],friendlyName:"Proxima Nova"},raleway:{referencePoints:[15,40,82],friendlyName:"Raleway"},"reklamescriptw00-medium":{referencePoints:[16,40,80],friendlyName:"Reklame Script"},"rosewood-w01-regular":{referencePoints:[15,39,81],friendlyName:"Rosewood"},sacramento:{referencePoints:[24,46,88],friendlyName:"Sacramento"},sail:{referencePoints:[22,46,88],friendlyName:"Sail"},sarina:{referencePoints:[16,40,82],friendlyName:"Sarina"},signika:{referencePoints:[16,42,84],friendlyName:"Signika"},"snellroundhandw01-scrip":{referencePoints:[20,46,88],friendlyName:"Snell Roundhand"},"soho-w01-thin-condensed":{referencePoints:[16,40,82],friendlyName:"Soho Condensed"},spinnaker:{referencePoints:[15,40,82],friendlyName:"Spinnaker"},"stencil-w01-bold":{referencePoints:[14,38,78],friendlyName:"Stencil"},tahoma:{referencePoints:[15,40,82],friendlyName:"Tahoma"},'"times new roman"':{referencePoints:[16,42,86],friendlyName:"Times New Roman"},"trend-sans-w00-four":{referencePoints:[14,38,74],friendlyName:"Trend"},verdana:{referencePoints:[15,40,82],friendlyName:"Verdana"}},c={min:14,max:105},s={min:1,max:40},u=[[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14],[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],[17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],[18,18,18,18,18,18,18,18,18,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17],[19,19,19,19,19,18,18,18,18,18,18,18,18,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17],[20,20,20,20,19,19,19,19,19,19,19,19,18,18,18,18,18,18,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17],[21,21,21,20,20,20,20,19,19,19,19,19,19,19,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18],[22,22,21,21,21,21,20,20,20,20,20,19,19,19,19,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18],[22,22,21,21,21,21,20,20,20,20,20,19,19,19,19,19,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18],[23,23,22,22,21,21,21,20,20,20,20,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19],[25,24,23,23,22,22,22,21,21,21,20,20,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19],[26,25,24,23,23,22,22,22,21,21,21,20,20,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19],[27,26,25,24,24,23,23,22,22,21,21,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],[28,27,26,25,24,23,23,22,22,21,21,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],[29,28,27,26,25,24,23,22,22,21,21,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],[30,29,28,27,26,25,24,23,23,22,22,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21],[31,30,29,28,27,26,25,24,23,23,22,22,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21],[32,31,30,29,28,27,26,25,24,23,23,22,22,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21],[33,32,31,30,29,28,27,26,25,24,24,23,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22],[34,33,32,31,30,29,28,27,26,25,24,23,23,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22],[34,33,32,31,30,29,28,27,26,25,24,23,23,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22],[35,34,33,32,31,30,29,28,27,26,25,24,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23],[35,34,33,32,31,30,29,28,27,26,25,24,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23],[36,35,34,33,32,31,30,29,28,27,26,25,24,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23],[36,35,34,33,32,31,30,29,28,27,26,25,24,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23],[37,36,34,34,33,32,31,30,29,28,27,26,25,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],[37,36,34,34,33,32,31,30,29,28,27,26,25,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],[37,36,34,34,33,32,31,30,29,28,27,26,25,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],[38,36,34,34,33,32,31,30,29,28,27,26,25,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],[38,36,34,34,33,32,31,30,29,28,27,26,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],[38,36,34,34,33,32,31,30,29,28,27,26,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],[39,36,34,34,33,32,31,30,29,28,27,26,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],[39,36,34,34,33,32,31,30,29,28,27,26,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],[39,36,34,34,33,32,31,30,29,28,27,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26],[39,36,34,34,33,32,31,30,29,28,27,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26],[40,36,34,34,33,32,31,30,29,28,27,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26],[40,36,34,34,33,32,31,30,29,28,27,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26],[40,36,34,34,33,32,31,30,29,28,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27],[40,36,34,34,33,32,31,30,29,28,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27],[40,36,34,34,33,32,31,30,29,28,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27],[40,36,34,34,33,32,31,30,29,28,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27],[40,36,34,34,33,32,31,30,29,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[40,36,34,34,33,32,31,30,29,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[40,36,34,34,33,32,31,30,29,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[40,36,34,34,33,32,31,30,29,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[40,36,34,34,33,32,31,30,29,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[40,36,34,34,33,32,31,30,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29],[40,36,34,34,33,32,31,30,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29],[40,36,34,34,33,32,31,30,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29],[40,36,34,34,33,32,31,30,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29],[40,36,34,34,33,32,31,30,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29],[40,36,34,34,33,32,31,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[40,37,34,34,33,32,31,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[40,37,34,34,33,32,31,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[40,37,35,34,33,32,31,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[40,37,35,34,33,32,31,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[40,37,35,34,33,32,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31],[40,37,35,34,33,32,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31],[40,37,35,34,33,32,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31],[40,37,35,34,33,32,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31],[40,37,35,34,33,32,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31],[40,37,35,34,33,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],[40,37,35,34,33,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],[40,37,35,34,33,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],[40,37,35,34,33,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],[40,37,35,34,33,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],[40,37,35,34,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33],[40,37,35,34,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33],[40,37,35,34,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33],[40,37,35,34,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33],[40,37,35,34,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33],[40,37,35,34,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33],[40,37,35,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],[40,37,35,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],[40,37,35,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],[40,37,35,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],[40,37,35,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],[40,37,35,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],[40,37,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35],[40,37,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35],[40,37,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35],[40,37,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35],[40,37,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35],[40,37,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35],[40,37,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36],[40,37,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36],[40,37,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36],[40,37,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36],[40,37,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36],[40,37,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36],[40,38,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37]],l=[15,40,82];function f(e,n,t){return Math.max(Math.min(e,t),n)}var d=t(2),m=t(5);const p=(e,n)=>m.a(e,n),g=e=>i.map(m.b(e),"comps"),h=e=>i.get(e,["metaData","author"]);function y(e){const n=i.get(e,["metaData","originalCompId"]),t=h(e)||"studio";return i.assign({recommendedWidth:e.layout.width,recommendedHeight:e.layout.height,recommendedScale:e.layout.scale,author:t},n?{originalCompId:n}:{})}function v(e,n,t){return e?"rightTop"===t?{offsetX:n.layout.x-e.layout.x-e.layout.width,offsetY:n.layout.y-e.layout.y,offsetOrigin:t}:"leftBottom"===t?{offsetX:n.layout.x-e.layout.x,offsetY:n.layout.y-e.layout.y-e.layout.height,offsetOrigin:t}:{offsetX:n.layout.x-e.layout.x,offsetY:n.layout.y-e.layout.y,offsetOrigin:"leftTop"}:{offsetX:n.layout.x,offsetY:n.layout.y,offsetOrigin:"leftTop"}}function C(e,n=0,t=0){return t?"leftTop":n?"rightTop":e?"leftBottom":"leftTop"}function T(e){const n=i.map(e,"id"),t=p(e,"y"),o=g(t);return i.reduce(o,(e,t,o)=>{if(1===i.size(t))return[...e,{preset:t[0],offsetOrigin:C(o)}];const r=p(t,"x"),a=g(r);return i.reduce(a,(e,t,r)=>{if(1===i.size(t))return[...e,{preset:t[0],offsetOrigin:C(o,r)}];const a=i.sortBy(t,e=>n.indexOf(e.id)),c=i.map(a,(e,n)=>({preset:e,offsetOrigin:C(o,r,n)}));return[...e,...c]},e)},[])}function E(e){const n=i.map(e.components,e=>E(e)),t=T(e.components),o=i.reduce(t,(e,n,o)=>{const r=i.get(t,[o-1,"preset"],null),a=i.assign({},y(n.preset),v(r,n.preset,n.offsetOrigin),{orderIndex:o});return i.set(e,n.preset.id,a)},{});return i.assign(o,...n)}function D(e){if(!e.mobileStructure)return;const n=i.assign({metaData:{}},i.pick(e,["id","componentType","type"]),i.pick(e.mobileStructure,["layout"]),i.pick(e.mobileStructure,"metaData"));if(i.has(e,"components")){const t=i(e.components).map(D).compact().value();i.set(n,"components",t)}return n}var O=t(1);const b={color_11:"tmFull1",color_27:"tmFull1",color_32:"tmFull1",color_15:"tmFull2",color_18:"tmFull2",color_25:"tmFull2"},N={type:"Component",id:"TINY_MENU",componentType:"wysiwyg.viewer.components.mobile.TinyMenu",skin:"wysiwyg.viewer.skins.mobile.TinyMenuFullScreenSkin",layout:i.merge(O.getTinyMenuDefaultPosition(),{height:d.a.TINY_MENU_SIZE,width:d.a.TINY_MENU_SIZE}),dataQuery:"#TINY_MENU",styleId:"tmFull1"},S="SITE_HEADER",I={tmFull1:{skin:"wysiwyg.viewer.skins.mobile.TinyMenuFullScreenSkin",style:{properties:{borderwidth:"0",bg:"color_11","alpha-bg":0,txt:"color_11",separatorHeight:"0",textAlignment:"center",txts:"color_18",iconcolor:"color_15",iconcolorSelected:"color_11"}}},tmFull2:{skin:"wysiwyg.viewer.skins.mobile.TinyMenuFullScreenSkin",style:{properties:{borderwidth:"0",bg:"color_11","alpha-bg":0,txt:"color_11",separatorHeight:"0",textAlignment:"center",txts:"color_18",iconcolor:"color_11",iconcolorSelected:"color_11"}}},tm2:{skin:"wysiwyg.viewer.skins.mobile.TinyMenuSkin",style:{properties:{bg:"color_11",bgh:"color_13",bgs:"color_18",txts:"color_15",txt:"color_15"}}}},x=()=>I;function M(e){const n=O.getComponentByIdFromStructure(S,e),t=i.get(b,i.get(n.conversionData,"backgroundColor"),"tmFull1"),o=i.defaults({styleId:t},N);O.addComponentsTo(n,[o]),O.ensureContainerTightlyWrapsChildren(n,n.components,!0)}const _={type:"Component",id:"BACK_TO_TOP_BUTTON",componentType:"wysiwyg.common.components.backtotopbutton.viewer.BackToTopButton",skin:"wysiwyg.viewer.skins.backtotopbutton.BackToTopButtonSkin",layout:{height:0,width:0,x:0,y:0},dataQuery:null,styleId:""},P=e=>O.addComponentsTo(e,[_]),w={TINY_MENU:o,BACK_TO_TOP_BUTTON:r},A=["TINY_MENU","BACK_TO_TOP_BUTTON","QUICK_ACTION_BAR","QUICK_ACTION_BAR_ITEM","MENU_AS_CONTAINER_TOGGLE","MENU_AS_CONTAINER_EXPANDABLE_MENU"],R=["wysiwyg.viewer.components.mobile.TinyMenu","wysiwyg.viewer.components.BackToTopButton","wysiwyg.common.components.backtotopbutton.viewer.BackToTopButton","wysiwyg.viewer.components.QuickActionBar","wysiwyg.viewer.components.QuickActionBarItem","wysiwyg.viewer.components.MenuToggle","wysiwyg.viewer.components.ExpandableMenu"],k=e=>i.includes(R,i.get(e,"componentType"));function B(e,n){const t=w[n];t&&!O.getComponentByIdFromStructure(n,e)&&t.addToStructure(e)}function L(e,n){if(!n)return;const t=[];let o=0;for(;o<n.length;){const r=n[o];O.isVirtualGroup(r)&&(O.translateComps(r.components,r.layout.x,r.layout.y),O.addComponentsTo(e,r.components,o+1),t.push(r)),o++}O.removeChildrenFrom(e,t),i.forEach(n,e=>L(e,e.components))}let G=1e3;function F(e){return i.assign(e,{type:"undefined",id:`${i.toLower(e.componentType)}_${G++}`,skin:"undefined",styleId:"undefined"})}function H(e,n,t,o){const r=F({layout:O.getSnugLayout(n),conversionData:i.assign(t,{hasTightYMargin:!0,isTightContainer:!0,marginX:0}),componentType:d.a.VIRTUAL_GROUP_TYPES.RESCALE,components:n});return O.translateComps(n,-r.layout.x,-r.layout.y),O.removeChildrenFrom(e,n),O.addComponentsTo(e,[r],o),r}function j(e){i.forEach(e,e=>{e.layout&&!O.isFixedPositionAllowed(e)&&(e.layout.fixedPosition=!1)})}function z(e,n,t){const o=O.getAllCompsInStructure(e);return t.keepEmptyTextComponents||function e(n){let t;let o;if(n)for(t=n.length-1;t>=0;t--)o=n[t],O.isTextComponent(o)?0===i.get(o.conversionData,"textLength",0)&&n.splice(t,1):e(o.components)}(n),function e(n){i.remove(n,(t,o)=>!!(O.isScreenWidthComponent(t)&&i.get(t,["conversionData","isSolidColorBackground"])&&((e,n)=>i.find(n,n=>O.isScreenWidthComponent(n)&&e.layout.y===n.layout.y&&e.layout.height===n.layout.height))(t,i.slice(n,o+1)))||(e(t.components),!1))}(n),j(o),i.forEach(n,Y),V(e,n),X(e,n,t.keepNotRecommendedMobileComponents),t.keepOutOfScreenComponents||function e(n,t,o,r){let i=0;let a;let c;let s;let u;if(t)for(;i<t.length;)a=t[i],c=a.layout.y+a.layout.height,s=a.layout.x+a.layout.width,(u=c+r<0||a.layout.x>1500||s+o<-500)?t.splice(i,1):(e(a,a.components,o+a.layout.x,r+a.layout.y),i++);return n}(e,n,0,0),function e(n){i.forEachRight(n,(t,o)=>{let r=q(t,i.slice(n,0,o))||q(t,i.slice(n,o),e=>i.get(e,["conversionData","isSemiTransparentContainer"],!1));if(!function(e,n){return n&&(i.get(n,["conversionData","nestOverlayingSiblings"],!0)||O.shouldReparentCompToChildOfContainer(e,n))&&!i.get(e,["conversionData","isNonContainableFullWidth"],!1)}(t,r))return void e(t.components);let a=0;O.isColumnsContainerComponent(r)&&(a=r.layout.y,r=i.head(r.components)),O.reparentComponent(r,t),t.layout.y-=a,n.splice(o,1)});return n}(n),t.keepOccludedAndEmptyBackgrounds||function e(n){const t=e=>e.conversionData.hideWhenEmptyBackgroundContainer&&e.conversionData.isSolidColorBackground&&O.isEmptyContainer(e);i.remove(n,n=>!!t(n)||("columns"===i.get(n,["conversionData","category"])&&i.every(n.components,t)||e(n.components),!1))}(n),O.isMasterPage(e)&&W(n),t.keepInvisibleComponents||function e(n){i.forEachRight(n,(t,o)=>{const r=i.slice(n,o+1),a=q(t,r,i.negate(e=>i.get(e,["conversionData","isSemiTransparentContainer"],!1)||i.get(e,["conversionData","structuralItem"],!1)),1);a?(i.set(t,["conversionData","mobileHints","hidden"],!0),n.splice(o,1)):e(t.components)})}(n),e}function W(e){const n=i.find(e,{id:"SITE_HEADER"}),t=i.find(e,{id:"SITE_FOOTER"});i(e).remove(i.negate(O.isAllowedToBeInMasterPage)).forEach(e=>{const o=function(e,n){const t=e=>e.layout.y+(e.layout.height||0)/2,o=t(e);return i.size(n)?i.minBy(n,e=>{const n=Math.abs(o-t(e));return i.isNaN(n)?0:n}):null}(e,[n,t]);O.reparentComponent(o,e)})}const U=(e,n)=>i.reduce(e,(e,n)=>(e[n.id]=n,n.components&&U(n.components,e),e),n);function Y(e){i.forEach(e.components,Y);const n=i.get(e,["conversionData","actualTextWidth"]);if(i.isUndefined(n)||n>=e.layout.width)return;if(0===n)return void(e.layout.width=0);const t=i.get(e,["conversionData","textAlignments"],["left"]);if(1===i.size(t)){switch(i.head(t)){case"center":e.layout.x+=(e.layout.width-n)/2;break;case"right":e.layout.x+=e.layout.width-n}e.layout.width=n}}function V(e,n){let t=0;for(;t<i.size(n);){const o=n[t],r=o.components;i.get(o,["conversionData","mobileHints","hidden"])?(O.isContainerComponent(o)&&(O.translateComps(r,o.layout.x,o.layout.y),O.addComponentsTo(e,r),o.components=[]),n.splice(t,1)):(O.isColumnsContainerComponent(o)?(i(r).filter("conversionData.mobileHints.hidden").forEach(e=>O.translateComps(e.components,o.layout.x,o.layout.y)),V(e,r)):V(o,r),t++)}}function X(e,n,t){O.isMergeVirtualGroup(e)||i.remove(n,e=>{if(i.get(e,["conversionData","desktopOnly"])||!t&&i.get(e,["conversionData","hideByDefault"]))return!0;X(e,e.components,t)})}function q(e,n,t,o=.75){return O.isSiteSegmentOrPage(e)?null:i.find(n,n=>n.id!==e.id&&"PAGES_CONTAINER"!==n.id&&(!t||t(n))&&(O.isContainerComponent(n)||O.isPageComponent(n))&&(O.haveSufficientOverlap(n,e,o)||e.conversionData.isInvisible&&O.getYOverlap(n,e)>0)&&O.hasGreaterArea(n,e))}var Q=t(4);const K=90;function Z(e,n){i.forEachRight(Object(O.getChildren)(e),(t,o)=>{J(t)?!$(t)||ee(t)?n&&function(e,n){const t=Object(O.getChildren)(e);i.remove(e.conversionData.componentsOrder,t[n].id),t.splice(n,1)}(e,o):function(e){e.layout.rotationInDegrees=K,i.assign(e.layout,Q.boundingLayout.getBoundingLayout(e.layout))}(t):Z(t,n)})}const J=e=>i.get(e,["conversionData","keepIfVerticalDivider"],!1),$=e=>J(e)&&i.get(e,["conversionData","isVerticalDivider"],!1),ee=e=>e.layout.rotationInDegrees===K;function ne(e,n){!function e(n){i.forEach(Object(O.getChildren)(n),n=>{$(n)?ee(n)&&(n.layout.rotationInDegrees=-K,i.assign(n.layout,Q.boundingLayout.getBoundingLayout(n.layout)),n.layout.rotationInDegrees=K):e(n)})}(e),L(e,n)}function te(e){return e.layout&&(delete e.layout.anchors,k(e)||Object(O.isDockingAllowed)(e)||delete e.layout.docked),delete e.conversionData,e}function oe(e){const n=Object(O.getAllCompsInStructure)(e);return i.forEach(n,te),te(e)}function re(e,n){return i.reduce(n,(n,t,o)=>(e[o]&&t.componentType&&e[o].componentType!==t.componentType&&n.push(o),n),[])}function ie(e,n){return[...i.difference(i.keys(e),i.keys(n)),...re(e,n)]}function ae(e,n){const t=i.difference(i.keys(n),i.keys(e));i.forEach(t,e=>delete n[e])}function ce(e,n){i.forEach(O.getAllCompsInStructure(n),n=>{const t=O.getComponentByIdFromStructure(n.id,e);t&&i.forEach(["dataQuery","nickname","behaviorQuery","connectionQuery"],e=>{t.hasOwnProperty(e)?n[e]=t[e]:delete n[e]})})}function se(e,n){const t=i(e).filter(["conversionData.mobileHints.hidden",!0]).map("id").value(),o=function(e,n){if(i.isEmpty(n))return[];const t=i(n).filter(n=>!0===i.get(e,[n,"conversionData","filterChildrenWhenHidden"])).uniq().value(),o=i(t).filter(n=>i.get(e[n],["conversionData","structuralContainer"],!1)).flatMap(n=>i.map(O.getAllCompsInStructure(e[n],!1)||[],"id")).compact().value(),r=i(t).filter(n=>O.isColumnsContainerComponent(e[n])).flatMap(n=>i.get(e[n],"components",[])).map("id").compact().value(),a=i.union(o,r);return i.difference(a,n)}(e,t),r=[...t,...o],a=i(n).values().reject(k).map("id").value(),c=i.intersection(a,r),s=i.map(e,"id"),u=i.difference(a,s),l=re(e,n);return{idsOfComponentsToDelete:i.uniq([...l,...u,...c]),idsOfComponentsToAdd:i.difference(ie(e,n),r)||[]}}var ue=t(3);function le(e,n){!function(e,n){i.forEach(n,(t,o)=>{t.conversionData.isTransparentContainer&&(t=i.head(t.components)||t);const r=n[o-1],a=Boolean(r),c=a&&r.layout.y+r.layout.height===t.layout.y&&r.layout.x===t.layout.x,s=i.get(e,["conversionData","hasTightMarginBetweenChildren"],!1);t.conversionData.tightWithPreviousSibling=c||a&&s})}(e,n),function(e,n){e.conversionData.hasTightBottomMargin=i.some(n,n=>{const t=i.get(n,["conversionData","isTransparentContainer"])&&!i.isEmpty(n.components)?i.head(n.components):n;return O.shouldStretchToScreenWidth(t)&&t.layout.y+t.layout.height>=e.layout.height})}(e,n),function(e){const n=i.size(e)-1;i.forEach(e,e=>{const t=O.getChildren(e);e.conversionData.hasTightYMargin=!0===e.conversionData.isTightContainer||i.isEmpty(t)||!0===e.conversionData.isTransparentContainer&&(0===n||"column"!==e.conversionData.category)})}(n),function(e,n){const t=i(n).map(e=>{const n=e.conversionData.textAlignments||[];return i(n).uniq().size()>1?"mixed":i.head(n)}).compact().uniq().value();1===i.size(t)&&(e.conversionData.naturalAlignment=i.head(t))}(e,n)}function fe(e,n){!function e(n,t){if(i.isEmpty(n.components))return;n.proportionGroups=n.proportionGroups||[];const o=[];const r=Q.objectUtils.cloneDeep(n);const a=O.getChildren(r);for(;a.length>0;){let e=me(a[0],a);0!==e.length?(O.removeChildrenFrom(r,e),e.forEach(n=>{const t=me(n,a);e=e.concat(t),O.removeChildrenFrom(r,t)}),e.length>1&&o.push(i.map(e,"id"))):i.remove(O.getChildren(r),a[0])}n.proportionGroups=[...n.proportionGroups,...o];i.forEach(t,n=>e(n,n.components))}(e,n),function e(n,t){const o=e=>i.find(n.components,{id:e});i.forEach(n.proportionGroups,e=>{if(!i.every(e,o))return;const t=O.getComponentsByIds(n,e);H(n,t,{rescaleMethod:"proportional"})});i.forEach(t,n=>e(n,n.components))}(e,n),function e(n,t){delete n.proportionGroups;i.forEach(t,n=>e(n,n.components))}(e,n)}function de(e){return!O.isRescaleVirtualGroup(e)&&i.get(e,["conversionData","textLength"],0)<=d.a.TEXT_MAX_LENGTH_FOR_RESCALING&&i.get(e,["conversionData","isSuitableForProportionGrouping"],!1)&&i.every(e.components,de)}function me(e,n){return de(e)?i.filter(n,n=>de(n)&&O.haveSufficientOverlap(e,n,.25)):[]}const pe=500;function ge(e,n,t,o){if(t<.01)return"break";if(t<.1)return"tight";const r=()=>o>500?"h2v":"proportional",a=()=>o<500?"proportional":"tight",c=()=>"h2v",s={photo:{text:r,graphic:r,photo:()=>t>.5&&o<600?"proportional":"tight"},graphic:{text:r,graphic:r,photo:r},text:{text:()=>t>.5&&o<500?"proportional":"break"},columns:{text:c,photo:c,graphic:c},group:{text:a,photo:a,graphic:a}};return i.get(s,[e,n],()=>"break")()}const he=e=>e.layout.x,ye=e=>e.layout.y,ve=e=>e.layout.width,Ce=e=>e.layout.height,Te=e=>he(e)+ve(e),Ee=e=>ye(e)+Ce(e),De=e=>ve(e)*Ce(e),Oe=(e,n,t,o)=>({layout:{x:o,y:e,width:Math.max(0,n-o),height:Math.max(0,t-e)}}),be=(e,n)=>Oe(Math.max(ye(e),ye(n)),Math.min(Te(e),Te(n)),Math.min(Ee(e),Ee(n)),Math.max(he(e),he(n))),Ne=(e,n)=>Oe(Math.min(ye(e),ye(n)),Math.max(Te(e),Te(n)),Math.max(Ee(e),Ee(n)),Math.min(he(e),he(n)));function Se(e){return{rescaleMethod:"break",overlapRatio:0,conversionData:i.pick(e.conversionData,"category"),layout:e.layout,components:[e]}}function Ie(e,n){const t=De(be(e,n))/De(n);return{rescaleMethod:ge(e.conversionData.category,n.conversionData.category,t,ve(Ne(e,n))),overlapRatio:t}}function xe(e,n){if(1===i.size(n.components)&&i.get(n.components[0],["conversionData","isInvisible"],!1))return e;const t=i.map(e,e=>Ie(e,n)),o=function(e){const n=i(e).map((e,n)=>"break"!==e.rescaleMethod?n:null).filter(i.isNumber.bind(i)).value();return i.size(n)<=1?n:i.every(n,n=>"proportional"===e[n].rescaleMethod)?n:[i.maxBy(n,n=>e[n].overlapRatio)]}(t);if(i.isEmpty(o))return[...e,n];const r=i.reduce(o,(n,o)=>{const r=e[o];return function(e){if(!i.includes(["h2v","tight"],e.rescaleMethod))return e;const n="tight"===e.rescaleMethod?0:e.overlapRatio;return i.forEach(e.components,(e,t)=>{t&&(i.assign(e.conversionData,{tightWithPreviousSibling:!0,yOffsetRatio:n}),O.isTextComponent(e)&&(e.conversionData.yOffset=e.conversionData.mobileScale*e.conversionData.mobileAdjustedAverageFontSize*.5))}),e}(i.assign({components:[...r.components,...n.components],layout:Ne(n,r).layout,conversionData:{category:"group",isTightContainer:!0,marginX:0}},t[o]))},n);return i.remove(e,(e,n)=>i.includes(o,n)),e.push(r),i.reduce(e,xe,[])}const Me=e=>i(e).groupBy("conversionData.overlayGroupId").filter((e,n)=>n&&i.size(e)>1).value(),_e=e=>i(e).map(Se).reduce(xe,[]);function Pe(e){const n=O.getSnugLayout(e);return n.width>=pe?i.findIndex(e,e=>i.isEqual(O.getSnugLayout([e]),n)):-1}function we(e,n){return i.reduce(e,(e,t,o)=>{const r=Object(ue.e)(o-n)+(n?1:0);return e[r]?i.set(e,r,{components:[...e[r].components,t],rescaleMethod:"reorder"}):i.set(e,r,{rescaleMethod:"break",components:[t]})},[])}function Ae(e){const n=Pe(e);return-1===n?[{rescaleMethod:"break",components:e}]:we(e,n)}function Re(e,n){const t={};return i.forEach(n,n=>{const o=H(e,n.components,{rescaleMethod:n.rescaleMethod,category:"boxContainer"}),r=i(n.components).map("id").reduce((e,n)=>i.set(e,n,o),{});i.assign(t,r)}),t}function ke(e,n){Be(e,Re(e,n))}function Be(e,n){e.conversionData.componentsOrder=i.reduce(e.conversionData.componentsOrder,(e,t)=>{const o=i.get(n,[t,"id"],t);return i.includes(e,o)?e:[...e,o]},[])}function Le(e,n){ke(e,i(Me(n)).flatMap(Ae).filter({rescaleMethod:"reorder"}).value())}function Ge(e,n){const t=i(Me(n)).map(n=>Object(ue.h)(e,n)).flatMap(_e).reject({rescaleMethod:"break"}).value();ke(e,t)}const Fe={LOGO:{min:-10,max:25},ROW:{min:-10,max:80}},He={MARKER:3,LOGO_TITLE:20},je=100,ze=20,We=2,Ue=2,Ye={ROW:{rescaleMethod:"row"},LOGO:{rescaleMethod:"logo"}},Ve=e=>!e.layout.fixedPosition&&!e.layout.rotationInDegrees,Xe=e=>-O.getXOverlap(e[0],e[1]),qe=(e,n)=>i.inRange(Xe(e),n.min,n.max),Qe=e=>O.isTextComponent(e)&&e.conversionData.textLength<=He.MARKER,Ke=e=>O.isGraphicComponent(e)&&e.layout.width<=je,Ze=e=>Ke(e)||Qe(e),Je=e=>i.find(e,Ze),$e=e=>i.find(e,["conversionData.inlineWhenGrouped",!0]),en=e=>(function(e){if(!i.every(e,O.isTextComponent)||!qe(e,Fe.LOGO))return!1;const n=i(["textColors","averageFontSize","fontNames"]).map(n=>i.isEqual(i.get(e,[0,"conversionData",n]),i.get(e,[1,"conversionData",n]))).compact().size(),t=i.sumBy(e,"conversionData.textLength");return n<=1&&t<=He.LOGO_TITLE}(e)||function(e){const n=i.find(e,["conversionData.category","text"]),t=i.find(e,["conversionData.category","graphic"]);if(!n||!t)return!1;return qe(e,Fe.LOGO)&&n.conversionData.textLength<=He.LOGO_TITLE&&t.layout.width<=je}(e))&&tn(e),nn=e=>i(e).sortBy("layout.x").map("id").value(),tn=e=>i.size(e)===We&&e[0]&&e[1]&&O.getYOverlap(e[0],e[1])>0;function on(e,n){i(n).map((e,t)=>(function(e,n,t){const o=[t[n-1],e],r=[e,t[n+1]];if(en(o)&&!en(r))return{groupComps:o,conversionData:Ye.LOGO}})(e,t,n)).compact().forEachRight(t=>rn(e,n,t))}function rn(e,n,t){const o=e.conversionData.componentsOrder.indexOf(t.groupComps[0].id),r=i.assign({},t.conversionData,{componentsOrder:nn(t.groupComps)}),a=H(e,t.groupComps,r,o);return e.conversionData.componentsOrder.splice(o,t.groupComps.length,a.id),n.splice(o,t.groupComps.length,a),a}function an(e,n){const t=Je(e);return qe(e,n)&&i.every(e,O.isTextComponent)&&Qe(t)}function cn(e,n){const t=Je(e),o=i.reject(e,t)[0];return qe(e,n)&&O.isTextComponent(o)&&Ke(t)}function sn(e){if(!i.every(e,Ve))return!1;const n=i.take(e,We),t=i.takeRight(e,We),o=function(e){const n=i.take(e,We),t=Xe(n);return{min:i.max([t-ze,Fe.ROW.min]),max:i.min([t+ze,Fe.ROW.max])}}(n);return(cn(n,Fe.ROW)&&cn(t,o)||an(n,Fe.ROW)&&an(t,o))&&tn(n)&&tn(t)}function un(e){const n=Ue*We,t={foundLists:[],curChunk:[]};return i.forEach(e,e=>{t.curChunk.push(e);const o=i.last(t.foundLists);return o&&i.size(t.curChunk)===We&&function(e,n){return sn([...i.take(e,We),...n])}(o,t.curChunk)?(o.splice(o.length,0,...t.curChunk),i.assign(t,{curChunk:[]})):i.size(t.curChunk)<n?void 0:sn(t.curChunk)?(t.foundLists.push(t.curChunk),i.assign(t,{curChunk:[]})):i.assign(t,{curChunk:i.tail(t.curChunk)})}),i.flatMap(t.foundLists,e=>(function(e){return i(e).map((n,t)=>t%We?{conversionData:Ye.ROW,groupComps:[e[t-1],n]}:null).compact().value()})(e))}function ln(e){if(Object(ue.g)(e))return;const n=Object(ue.d)(e);i.size(n)&&(!function(e,n){e.conversionData.isTightContainer&&n.length===We&&!O.shouldStretchToScreenWidth(e)&&qe(n,Fe.ROW)&&$e(n)&&i.assign(e.conversionData,Ye.ROW,{componentsOrder:nn(n)})}(e,n),function(e,n){const t=un(n);i.forEachRight(t,t=>rn(e,n,t))}(e,n),on(e,n))}function fn(e){if(Object(ue.f)(e))return;ln(e);const n=Object(ue.d)(e);i.forEach(n,fn)}function dn(e,n){const t=O.getChildren(e);if(!t)return;const o=i.map(t,"id"),r=i.get(e,["conversionData","mobileHints","recommendedComponentsOrder"]);r?i.set(e,["conversionData","componentsOrder"],i.intersection(r,o)):(Object(ue.g)(e)?i.set(e,["conversionData","componentsOrder"],o):(Object(m.c)(e,t,n),n.detectSemanticGroups&&n.useOverlapRules&&function(e){Le(e,Object(ue.d)(e)),Ge(e,Object(ue.d)(e))}(e)),le(e,Object(ue.d)(e))),i.forEach(Object(ue.d)(e),e=>dn(e,n))}function mn(e,n){i.defaults(e,{conversionData:{}});const t=O.getChildren(e);t&&(n.detectSemanticGroups&&(G=1e3,n.useOverlapRules||fe(e,t)),dn(e,n),n.applySemanticRules&&fn(e),function e(n,t=d.a.MOBILE_WIDTH){const o=t-2*d.a.SECTION_MOBILE_MARGIN_Y;i.forEach(n,n=>{"appWidget"===n.conversionData.category&&(i.assign(n.conversionData,i.pick(i.get(n,["components",0,"conversionData"],{}),"fixedSize")),i.assign(n.conversionData.mobileHints,i.pick(i.get(n,["components",0,"conversionData","mobileHints"],{}),["recommendedWidth","recommendedHeight"]))),ue.f(n)||("boxContainer"===n.conversionData.category&&n.layout.width<=o?i.assign(n.conversionData,{rescaleMethod:"none",fixedSize:{width:n.layout.width}}):"boxContainer"===n.conversionData.category&&!n.conversionData.rescaleMethod&&n.layout.width<=400?i.assign(n.conversionData,{rescaleMethod:"proportional"}):e(O.getChildren(n),O.shouldStretchToScreenWidth(n)?t:o))})}(t),Z(e,!n.keepNotRecommendedMobileComponents))}const pn=.96;function gn(e,n,t=["x","y","width","height"]){1!==n&&i.assign(e.layout,i.zipObject(t,i.map(t,t=>Math.round(e.layout[t]*n))))}function hn(e,n){gn(e,n),i.forEach(e.components,e=>hn(e,n)),yn(e,n)}function yn(e,n){if(!O.isTextComponent(e))return;const t=e.conversionData.averageFontSize||0;e.layout.scale=t*n*pn/e.conversionData.mobileAdjustedAverageFontSize}function vn(e,n){const t=i.get(e.conversionData,["mobileHints","recommendedHeight"]);if(t)return void(e.layout.height=t);if(O.isTextComponent(e))return void(e.layout.height=d.a.DEFAULT_TEXT_HEIGHT);const o=i.get(e.conversionData.fixedSize,"height"),r=e.layout.height,a=e.conversionData.minHeight||0;i.isNumber(o)?e.layout.height=o:i.get(e.conversionData,"preserveAspectRatio",!0)?e.layout.height=Math.round(e.layout.height*n.scaleFactor):a&&(e.layout.height=0),e.layout.height=a<r?Math.max(e.layout.height,a):r;const c=O.getHeightAccordingToChildren(e,i.reject(e.components,"conversionData.isInvisible"),!1);c&&(!o||o<=c||O.containsComponent(e,O.isTextComponent))&&(e.layout.height=c)}const Cn=e=>i.sortBy(e.components,n=>e.conversionData.componentsOrder.indexOf(n.id)),Tn=1,En=40,Dn=e=>i(e).filter(O.isTextComponent).forEach(e=>yn(e,1)),On=e=>i.maxBy(e,"conversionData.textLength"),bn=e=>e.layout.x+e.layout.width;function Nn(e,n){const t=Cn(e);if(Dn(t),n>=Tn)return void function(e,n){const t=On(n),o=e.layout.width-bn(n[1]);t.layout.width+=o,n[0]===t&&(n[1].layout.x+=o)}(e,t);const o=On(t),r=t[t.indexOf(o)?0:1],i=Object(O.isGraphicComponent)(r)?En:r.layout.width;if(r.layout.width*n>=i)return gn(r,n),void gn(o,n);const a=-Object(O.getXOverlap)(r,o),c=r.layout.width<i?r.layout.width:i,s=c/r.layout.width,u=(e.layout.width-c-a)/(bn(t[1])-r.layout.width-a),l=["width","height"];gn(r,s,l),gn(o,u,l),t[1].layout.x=bn(t[0])+a}function Sn(e,n,t,o){i.has(e,["conversionData","preset"])&&i.get(e,["conversionData","shouldApplyPreset"])?function e(n,t){return i.assign(n,i.omit(t,["conversionData","components"])),n.components&&(n.components=i(t.components).map(t=>{const o=O.getComponentByIdFromStructure(t.id,n);return o?e(o,t):null}).compact().value()),n}(e,e.conversionData.preset):e.layout.width>n||e.conversionData.shouldEnlargeToFitWidth||e.layout.width>d.a.MIN_WIDTH_FOR_ENLARGE||t||"row"===e.conversionData.rescaleMethod?xn(e,n,o):vn(e,{scaleFactor:1})}function In(e,n,t,o={imageScaleFactor:1,applyFontScaling:!0}){const r=n.conversionData.topRightMargin||[0,0],a=Cn(e),c=i.head(a),s=function e(n,t,o){return"leftTop"===i.get(o,["conversionData","mobileHints","offsetOrigin"])?i.get(o.conversionData,["mobileHints","offsetY"],0):n.conversionData.hasTightYMargin||!o?0:o.conversionData.isTransparentContainer?e(n,t,i.head(o.components)):O.shouldStretchToScreenWidth(o)&&!o.layout.y?0:(t.conversionData.borderWidth||0)+(O.shouldStretchToScreenWidth(t)?d.a.SECTION_MOBILE_MARGIN_Y:d.a.COMPONENT_MOBILE_MARGIN_Y)}(e,n,c);let u=s;i.forEach(a,(c,l)=>{const f=function(e,n){if("leftTop"===i.get(e.conversionData,["mobileHints","offsetOrigin"]))return i.get(e.conversionData,["mobileHints","offsetX"],0);if(n.conversionData.isTransparentContainer&&"column"!==n.conversionData.category)return 0;const t=n.conversionData.marginX;return i.isNumber(t)?t:(O.shouldStretchToScreenWidth(n)?d.a.SITE_SEGMENT_PADDING_X:d.a.COMPONENT_MOBILE_MARGIN_X)+i.get(n.conversionData,"borderWidth",0)}(c,n);(o.applyFontScaling&&O.isTextComponent(c)||c.conversionData.mobileScale)&&(c.layout.scale=c.conversionData.mobileScale);const m=O.shouldStretchToScreenWidth(c);let p=f,g=f;const h=c.conversionData.isInvisible||m?"screen":e.conversionData.naturalAlignment||"center";u<r[1]-s&&(g=Math.max(g,r[0]),"center"===h&&(p=g));const y=t-p-g,v=function(e,n,t,o,r){if(o)return n;const a=i.get(e.conversionData,["mobileHints","recommendedWidth"]);if(a)return a;if("photo"===e.conversionData.category&&1!==r.imageScaleFactor)return Math.min(t,Math.round(e.layout.width*r.imageScaleFactor));const c=i.get(e.conversionData.fixedSize,"width");return c?Math.min(n,+c):null}(c,t,y,m,o),C=i.isNumber(v);Sn(c,C?v:y,C,o),u<r[1]&&v>y&&!c.conversionData.isTransparentContainer&&(u=r[1],g=p=f),i.isNumber(c.conversionData.yOffset)?u-=c.conversionData.yOffset:c.conversionData.yOffsetRatio&&(u-=c.layout.height*c.conversionData.yOffsetRatio),c.layout.x=function(e,n,t,o,r,a){return"leftTop"===i.get(e,["conversionData","mobileHints","offsetOrigin"])?i.get(a,["layout","x"],0)+i.get(e.conversionData,["mobileHints","offsetX"],0):a&&"rightTop"===i.get(e,["conversionData","mobileHints","offsetOrigin"])?a.layout.x+a.layout.width+i.get(e.conversionData,["mobileHints","offsetX"],0):a&&"leftBottom"===i.get(e,["conversionData","mobileHints","offsetOrigin"])?a.layout.x+i.get(e.conversionData,["mobileHints","offsetX"],0):"screen"===n?0:"left"===n?r:"right"===n?t-e.layout.width-o:Math.round((t-e.layout.width)/2)}(c,h,t,g,p,a[l-1]),c.layout.y=u-(c.conversionData.isInvisible&&!l?s+1:0),c.conversionData.stackLayout||(u+=c.conversionData.isInvisible?1:c.layout.height+function(e,n){return"leftBottom"===i.get(n,["conversionData","mobileHints","offsetOrigin"])?i.get(n.conversionData,["mobileHints","offsetY"],0):e&&"rightTop"===i.get(n,["conversionData","mobileHints","offsetOrigin"])?i.get(n.conversionData,["mobileHints","offsetY"],0)-e.layout.height:e&&"leftTop"===i.get(n,["conversionData","mobileHints","offsetOrigin"])?i.get(n.conversionData,["mobileHints","offsetY"],0)-e.layout.height:!n||n.conversionData.tightWithPreviousSibling?0:O.isTextComponent(e)&&!O.isTextComponent(n)?d.a.MARGIN_BETWEEN_TEXT_AND_NON_TEXT:d.a.COMPONENT_MOBILE_MARGIN_Y}(c,a[l+1]))})}function xn(e,n,t={imageScaleFactor:1,applyFontScaling:!0}){const o=e.layout.width>0?n/e.layout.width:1,r=e.conversionData.rescaleMethod;"none"!==r&&(e.layout.width=n);const a=i.assign(t,{imageScaleFactor:e.conversionData.descendantImageScaleFactor||t.imageScaleFactor});switch(r){case"proportional":i.forEach(e.components,e=>hn(e,o));break;case"logo":!function(e,n){i.forEach(e.components,e=>hn(e,i.min([n,Tn])))}(e,o);break;case"row":Nn(e,o);break;case"none":break;default:In(e,e,n,a)}vn(e,{scaleFactor:o})}function Mn(e){const n={layout:O.getSnugLayout(e),conversionData:{rescaleMethod:"default",hasTightYMargin:!0,isTightContainer:!0},componentType:d.a.VIRTUAL_GROUP_TYPES.MERGE,components:e},t=F(n);return O.translateComps(e,-n.layout.x,-n.layout.y),t}function _n(e,n=[]){return n.push(e.id),i.forEach(O.getChildren(e),e=>{n=n.concat(_n(e))}),n}function Pn(e,n){return i.some(O.getChildren(n),{id:e.id})}function wn(e,n,t){i.defaults(e.conversionData,{blocks:[],blockLayout:[]});let o=O.getChildren(e);o||(o=e.components=[]);const r=function(e,n){const t=i.get(n,["conversionData","blocks"],[]);return i.findIndex(t,n=>i.includes(n,e))}(t,e),a=Q.objectUtils.cloneDeep(n);a.layout.y=function(e,n,t){const o=i.get(n,["conversionData","blockLayout"]);if(e>=0)return o[e].y+o[e].height+d.a.COMPONENT_MOBILE_MARGIN_Y;if(!O.shouldStretchToScreenWidth(t))return d.a.COMPONENT_MOBILE_MARGIN_Y;return n.layout.y?d.a.SECTION_MOBILE_MARGIN_Y:0}(r,e,n),o.push(a);const c=i.get(e,["conversionData","blockLayout",r+1,"y"]);if(i.isNumber(c)){Rn(e,r,a.layout.y+a.layout.height+d.a.COMPONENT_MOBILE_MARGIN_Y-c)}e.conversionData.blocks.splice(r+1,0,[a.id]),e.conversionData.blockLayout.splice(r+1,0,a.layout)}function An(e){const n=O.getChildren(e);if(O.isMasterPage(e)||i.isEmpty(n))return;const t=i.reduce(n,(e,n)=>Math.max(e,n.layout.y+n.layout.height),0),o=O.isPageComponent(e)?0:d.a.COMPONENT_MOBILE_MARGIN_Y;e.layout.height=Math.max(e.layout.height,t+o)}function Rn(e,n,t){const o=O.getChildren(e);let r,a,c,s;for(a=n+1;a<i.get(e,["conversionData","blocks","length"],0);a++){for(c=e.conversionData.blocks[a],r=0;r<c.length;r++)(s=i.find(o,{id:c[r]})).layout.y+=t;e.conversionData.blockLayout[a].y+=t}if(n>-1)for(c=i.get(e,["conversionData","blocks",n]),r=0;r<c.length;r++)s=i.find(o,{id:c[r]})}function kn(e,n,t){if(O.isMasterPage(e)){const o=O.getChildren(e);W(o),t.reparentMobileSOAP&&function(e,n){const t=U(e,{}),o=i.remove(n,e=>!k(e)&&t[e.id]&&!O.isAllowedToBeInMasterPage(t[e.id]));i.forEach(o,e=>{const n=i.get(t,[e.id,"conversionData"]);i.set(n,"fixedSize",{width:e.layout.width,height:e.layout.height}),i.set(n,["mobileHints","propertyQuery"],e.propertyQuery)})}(o,O.getChildren(n))}const o=O.getAllCompsInStructure(e,!1,i.negate(O.isDesktopOnlyComponent)),r=O.getAllCompsInStructure(n);Ln(n),function e(n,t){const o=O.getComponentByIdFromStructure(t.id,n);const r=i.get(o,"styleId");r&&i.set(t,"styleId",r);i.forEach(O.getChildren(t),e.bind(null,n))}(e,n);const a=se(o,r);if(a.idsOfComponentsToDelete.length>0||a.idsOfComponentsToAdd.length>0){const r=t.keepNotRecommendedMobileComponents?a.idsOfComponentsToAdd:Bn(a.idsOfComponentsToAdd,o);!function(e,n,t,o,r){Hn(e),Fn(e,n,o),function(e,n,t,o){const r=Q.objectUtils.cloneDeep(n);let a,c,s;z(r,O.getChildren(r),o);const u=function(e,n,t){const o=[];let r,a;for(r=e.length-1;r>=0;r--){const c=e[r],s=O.getComponentByIdFromStructure(c,n);if(O.isGroupComponent(s)){const n=i.partition(s.components,n=>i.includes(e,n.id)),c=i(n[1]).map(e=>O.getComponentByIdFromStructure(e.id,t)).compact().value();let u=!0;for(a=1;a<c.length;a++){const e=O.getParent(c[a-1].id,t),n=O.getParent(c[a].id,t);e.id!==n.id&&(u=!1)}if(!u){e.splice(r,1);continue}if(0===c.length)continue;const l=i.clone(s);l.components=[],l.layout=O.getSnugLayout(c);const f=O.getParent(c[0].id,t);for(O.addComponentsTo(f,[l]),a=0;a<c.length;a++){const e=c[a];O.reparentComponent(l,e),i.remove(O.getChildren(f),e)}o.push(e[r]),e.splice(r,1)}}return o}(t,r,e);i.isEmpty(u)||Hn(e),a=function(e,n){let t,o,r=[];const a=[];let c,s,u=e.map(e=>O.getComponentByIdFromStructure(e,n));return u=i.without(u,null),i.isEmpty(u)?a:(r=u.map(e=>(function(e){O.getChildren(e)&&(e.components=[],i.assign(e.conversionData,{blocks:[],blockLayout:[],componentsOrder:[]}))}(o=Q.objectUtils.cloneDeep(e)),o)),i.forEachRight(r,e=>{let n=!1;for(t=r.length-1;t>=0;t--)if(c=r[t],Pn(e,s=u[t])){n=!0,O.reparentComponent(c,e);break}n||a.push(e)}),a)}(t,r),mn(r,o),i.isEmpty(t)||(function(e,n){i.forEach(e,e=>{const n=i.head(e.componentToAdd);O.isRescaleVirtualGroup(n)&&(O.translateComps(n.components,n.layout.x,n.layout.y),e.componentToAdd=n.components),L(n,n.components)}),i.forEach(e,e=>{i.remove(e.componentToAdd,e=>!i.includes(n,e.id))})}(c=function e(n,t,o,r){let i,a,c;const s=O.getChildren(n);let u,l,f,d,m,p,g,h,y=[];if(s){for(u=r.map(e=>e.id),i=0;i<s.length;i++){if(l=s[i],f=l.id,d=!1,u.indexOf(f)>=0){for(d=!0,m=-1,c=0;c<r.length;c++)if(r[c].id===f){m=c;break}r.splice(m,1)}if(O.isVirtualGroup(l))for(a=0;a<l.components.length;a++)if(u.indexOf(l.components[a].id)>-1){for(d=!0,m=-1,c=0;c<r.length;c++)if(r[c].id===l.components[a].id){m=c;break}r.splice(m,1)}d&&(p=l,g=Vn(n,t,f,o),h=g?O.getParent(g,o):Yn(l,t,o),y.push({componentToAdd:[p],futureMobileContainerOfAddedComponent:h,previousComponentIdThatAlsoExistInMobile:g}))}for(i=0;i<s.length;i++)y=y.concat(e(s[i],t,o,r))}return y}(r,r,e,a),t),s=function(e){let n;const t=[];let o,r;return i.forEach(e,e=>{for(o=!1,n=0;n<t.length;n++)if(r=e.futureMobileContainerOfAddedComponent===t[n].futureMobileContainerOfAddedComponent&&e.previousComponentIdThatAlsoExistInMobile===t[n].previousComponentIdThatAlsoExistInMobile){t[n].componentToAdd=t[n].componentToAdd.concat(e.componentToAdd),o=!0;break}o||t.push(e)}),t}(c),function(e,n,t){const o=function(e,n){let t,o,r,a,c,s=[];for(t=0;t<e.length;t++)for(r=e[t].componentToAdd,o=0;o<r.length;o++)a=r[o],c=i.difference(_n(a),n),s=s.concat(c);return s}(n,t);Fn(e,o)}(e,s,t),function(e,n,t){const o={imageScaleFactor:1,applyFontScaling:t.applyFontScaling};let r,i,a,c,s;for(r=0;r<e.length;r++)i=e[r].componentToAdd,a=e[r].futureMobileContainerOfAddedComponent,c=e[r].previousComponentIdThatAlsoExistInMobile,z(s=Mn(i),s.components,t),mn(s,t),s.layout.x=0,s.layout.width=O.isPageComponent(a)||O.isScreenWidthComponent(a)||O.isMasterPage(a)?d.a.MOBILE_WIDTH:a.layout.width,In(s,a,s.layout.width,o),vn(s,{scaleFactor:1}),wn(a,s,c),An(a),ne(a,a.components||a.children),Hn(a)}(s,0,o)),[].splice.apply(t,[t.length,0].concat(u))}(e,r,o,t),(O.isContainerComponent(e)||O.isPageComponent(e))&&O.ensureContainerTightlyWrapsChildren(e,O.getChildren(e),!0)}(n,a.idsOfComponentsToDelete,t,r,e),function e(n,t){const o=["wysiwyg.viewer.components.BoxSlideShow","wysiwyg.viewer.components.StripContainerSlideShow"];i.forEach(O.getChildren(n),n=>{if(i.includes(o,n.componentType)){const e=O.getComponentByIdFromStructure(n.id,t),o=i.maxBy(n.components,"layout.height").layout.height;i.forEach(n.components,e=>i.assign(e.layout,{x:0,y:0,height:o})),n.layout.height=o,n.components=i.sortBy(n.components,n=>i.findIndex(e.components,{id:n.id}))}e(n,t)})}(n,e)}Gn(n)}function Bn(e,n){const t=i.reduce(n,(e,n)=>{const t=i.get(n,["layout","fixedPosition"])&&!i.get(n,["conversionData","convertFixedPositionToAbsolute"]),o=!O.isFixedPositionAllowed(n);return t&&o?i.concat(e,i.keys(O.getAllCompsInStructure(n))):e},[]);return i.difference(e,t)}function Ln(e){e.layout&&(e.existsBeforeMerge=!0),i.forEach(O.getChildren(e),Ln)}function Gn(e){delete e.existsBeforeMerge,i.forEach(O.getChildren(e),Gn)}function Fn(e,n,t){t=t||[];const o=e.components||e.children;let r,a,c,s;o&&(!function(e,n,t){const o=i.map(t,"id");i.forEachRight(e,e=>{if(i.includes(o,e))return;const t=O.getComponentsByIds(n,[e])[0];O.isGroupComponent(t)&&(O.removeGroup(t,n),Hn(n))})}(n,e,o),r=i.map(o,"id"),a=i.intersection(n,r),function(e,n,t){i(e).filter(e=>O.isContainerComponent(e)||O.isPageComponent(e)).forEach(e=>{i(e.components).map("id").filter(e=>!i.includes(t,e)).forEach(e=>{n.push(e)})})}(c=O.getComponentsByIds(e,a),t,n),c.length>0&&(s=c.map(e=>e.id).indexOf(function(e){const n=O.getChildren(e);let t,o,r,i;if(n){for(r=-Number.MAX_VALUE,t=0;t<n.length;t++)(i=n[t]).layout.y+i.layout.height>r&&(o=i,r=i.layout.y+i.layout.height);return o}}(e).id)>-1,O.removeChildrenFrom(e,c),function(e,n){const t=i.get(e,["conversionData","blocks"],[]),o=i.transform(t,(t,o,r)=>{const a=o.length;e.conversionData.blocks[r]=i.difference(o,n),a!==e.conversionData.blocks[r].length&&t.push(r)},[]);i.forEachRight(t,(n,t)=>{if(i.includes(o,t))return void(i.isEmpty(e.conversionData.blocks[t])&&(!function(e,n){Rn(e,n,-(e.conversionData.blockLayout[n].height+d.a.COMPONENT_MOBILE_MARGIN_Y))}(e,t),e.conversionData.blocks.splice(t,1),e.conversionData.blockLayout.splice(t,1)));const r=e.conversionData.blockLayout[t],a=O.getComponentsByIds(e,e.conversionData.blocks[t]),c=O.getSnugLayout(a);e.conversionData.blockLayout[t]=c;const s=c.y-r.y;0!==s&&Rn(e,t-1,-s);const u=r.height-e.conversionData.blockLayout[t].height,l=u-s;0!==u&&Rn(e,t,-l)})}(e,a),s&&O.ensureContainerTightlyWrapsChildren(e,o,!0,50)),i.forEach(o,e=>{Fn(e,n,t)}))}function Hn(e){i.has(e,"conversionData")||i.set(e,["conversionData"],{});const n=O.getChildren(e);if(!n)return;e.conversionData.blocks=[],e.conversionData.blockLayout=[];const t=Q.objectUtils.cloneDeep(n);t.sort(Wn);let o=[],r=0;i.forEach(t,(n,a)=>{if(o.push(n.id),a===t.length-1)return void jn(e,o);const c=i.slice(t,r,a+1);i.some(c,e=>zn(e,t[a+1]))||(jn(e,o),o=[],r=a+1)}),i.forEach(n,e=>Hn(e))}function jn(e,n){const t=O.getComponentsByIds(e,n),o=O.getSnugLayout(t);e.conversionData.blockLayout.push(o),e.conversionData.blocks.push(n)}const zn=(e,n)=>O.getYOverlap(e,n)/Math.min(e.layout.height,n.layout.height)>.25;function Wn(e,n){if(!zn(e,n)&&e.layout.y!==n.layout.y)return e.layout.y<n.layout.y?-1:1;const t=O.isScreenWidthComponent(e),o=O.isScreenWidthComponent(n);return t?o?0:-1:o?1:e.layout.x<n.layout.x?-1:e.layout.x>n.layout.x?1:0}function Un(e,n){if(i.get(n,["conversionData","nestOverlayingSiblings"],!0))return!0;const t=i.map(O.getChildren(n),"id");return i.includes(t,e)}function Yn(e,n,t){const o=e.id,r=function e(n){let t={};const o=O.getChildren(n);if(o)for(const r of o)t[r.id]=n.id,t=i.merge(t,e(r));return t}(n);let a,c,s=r[o];for(;!a||!Un(e.id,c);){const o=(a=O.getComponentByIdFromStructure(s,t))?O.getChildren(a):[];if(c=O.getComponentByIdFromStructure(s,n),s=r[s],O.shouldReparentCompToChildOfContainer(e,c)&&!i.isEmpty(o))return i.head(o)}return a}function Vn(e,n,t,o){if(O.isVirtualGroup(e))return Vn(O.getParent(e.id,n),n,e.id,o);const r=i.get(e,["conversionData","componentsOrder"],[]);for(let n=r.indexOf(t)-1;n>=0;n--){const t=r[n];if("PAGES_CONTAINER"===t)continue;const a=i.find(O.getChildren(e),{id:t});if(O.getComponentByIdFromStructure(t,o))return t;if(O.isVirtualGroup(a))for(let e=0;e<a.components.length;e++){const n=i.get(a,["conversionData","componentsOrder",e]);if(O.getComponentByIdFromStructure(n,o))return n}}return null}function Xn(e,n){return i(e).map(e=>O.getComponentByIdFromStructure(e,n)).compact().value()}function qn(e,n){const t=Xn(e,n),o=function(e){return i.map(e,e=>{const n=Q.objectUtils.cloneDeep(e);return O.getChildren(n)&&(n.components=[]),n})}(t),r=[];return i.forEach(o,e=>{for(let n=0;n<o.length;n++){const r=t[n];if(i.some(O.getChildren(r),{id:e.id})){const t=o[n];return void O.addComponentsTo(t,[e])}}r.push(e)}),r}function Qn(e,n,t,o={}){const r=O.getChildren(e);return r?(i.forEach(r,r=>{Qn(r,n,t,o);const a=i(t).remove({id:r.id}).head();if(i.isEmpty(a))return;const c=O.getComponentByIdFromStructure(e.id,n)||n;o[c.id]=o[c.id]||{componentsToAdd:[],parent:c},o[c.id].componentsToAdd.push(a)}),o):o}function Kn(e){return O.getAllCompsInStructure(e,!1,i.negate(k))}function Zn(e,n,t){const o=i.keys(t),r=i.difference(o,e),a=re(n,t);return i.uniq([...r,...a])}function Jn(e,n){if(i.isEmpty(n))return;const t=O.getChildren(e);if(!t)return;const o=i.map(t,"id"),r=i.remove(n,e=>i.includes(o,e)),a=O.getComponentsByIds(e,r);a.length>0&&O.removeChildrenFrom(e,a),i.forEach(t,e=>Jn(e,n))}function $n(e,n){return i.some(Object(O.getChildren)(n),n=>n.id===e)}function et(e,n){return i.find(n,n=>$n(e,n))}function nt(e,n,t){if(i.isEmpty(t))return;const o=Qn(n,e,qn(t,n));i.forEach(o,e=>{const n=Q.objectUtils.cloneDeep(e.componentsToAdd),t=i.flatMap(n,e=>i.values(O.getAllCompsInStructure(e)));i.forEach(t,e=>O.shouldStretchToScreenWidth(e)?i.set(e,["layout","width"],d.a.MOBILE_WIDTH):i.set(e,["layout","width"],i.min([e.layout.width,d.a.MOBILE_WIDTH]))),O.addComponentsTo(e.parent,n)}),function(e,n,t){const o=O.getAllCompsInStructure(n),r=O.getAllCompsInStructure(t),a=i.filter(e,e=>i.has(o,e));i.forEach(a,e=>{const n=et(e,o),t=et(e,r);if(n.id===t.id){const o=Object(O.getChildren)(n),r=i.filter(Object(O.getChildren)(t),e=>$n(e.id,n)),a=i.get(r,[i.findIndex(r,{id:e})+1,"id"],null);if(a){const n=i.remove(o,{id:e});o.splice(i.findIndex(o,{id:a}),0,i.head(n))}}})}(t,e,n)}function tt(e,n){const t=function(e){return O.getAllCompsInStructure(e,!1,i.negate(O.isDesktopOnlyComponent))}(e);var o;o=e,j(t),X(o,O.getChildren(o),!0),O.isMasterPage(o)&&W(O.getChildren(o));const r=i(t).reject(["conversionData.mobileHints.hidden",!0]).map("id").value();Jn(n,Zn(r,t,Kn(n))),Jn(n,function(e,n){const t=Xn(e,n);return i(t).flatMap(e=>i.values(O.getAllCompsInStructure(e))).map("id").uniq().difference(e).value()}(i.difference(r,i.keys(Kn(n))),e)),nt(n,e,i.difference(r,i.keys(Kn(n))))}const ot=d.a.MOBILE_WIDTH,rt={HEADER:"SITE_HEADER",SUBHEADER:"SUBHEADER",FOOTER:"SITE_FOOTER",PAGES_CONTAINER:"PAGES_CONTAINER",TINY_MENU:"TINY_MENU"},it=[rt.HEADER,rt.SUBHEADER,rt.PAGES_CONTAINER,rt.FOOTER],at=e=>i.get(e,["conversionData","siteSegmentRole"],"");function ct(e){!function(e){let n=i.findIndex(e,e=>rt.HEADER===i.get(e,["conversionData","siteSegmentRole"]));const t=i.findIndex(e,e=>rt.SUBHEADER===i.get(e,["conversionData","siteSegmentRole"]));if(-1!==n&&-1!==t&&t!==n+1){const o=e.splice(t,1)[0];n=i.findIndex(e,e=>rt.HEADER===i.get(e,["conversionData","siteSegmentRole"])),e.splice(n+1,0,o)}}(e),st(e)}function st(e){!function(e){const n=i.find(e,{id:rt.PAGES_CONTAINER}),t=i.get(n,["components",0,"layout"]);i.assign(t,{width:ot,x:0})}(e),function(e){let n=0;i.forEach(it,t=>{const o=i.find(e,e=>at(e)===t);o&&(i.assign(o.layout,{x:0,width:ot,y:n}),n+=o.layout.height)})}(e)}function ut(e){!function(e){i(e.children).filter(O.isSiteSegment).reject({id:rt.PAGES_CONTAINER}).forEach(e=>{xn(e,ot),Object(O.ensureContainerTightlyWrapsChildren)(e,e.components,!0)})}(e),ct(Object(O.getChildren)(e)),function(e){B(e,rt.TINY_MENU)}(e)}function lt(e,n,t){if(ce(e,n),kn(e,n,t),"masterPage"===n.id){const o=O.getChildren(n),r=O.getChildren(e);i.forEach(o,e=>i.set(e,"conversionData",i.get(i.find(r,{id:e.id}),"conversionData"))),t.fixMasterPageStructureOrder?ct(o):st(o)}return oe(n),O.getChildren(n)}function ft(e,n,t){t.analyzeOnly||z(e,n,t),mn(e,t)}t.d(n,"textUtils",function(){return dt}),t.d(n,"structuresComparer",function(){return mt}),t.d(n,"mobileOnlyComponents",function(){return pt}),t.d(n,"conversion",function(){return gt}),t.d(n,"mobileHints",function(){return ht}),t.d(n,"conversionUtils",function(){return O}),t.d(n,"conversionConfig",function(){return d.a});const dt={getFontSizeByFontName:function(e,n,t=a){if(0===n)return 0;const o=t[e];return o?function(e,n,t){const o=t<e[1]?e[0]:e[1],r=t<e[1]?n[0]:n[1],i=t<e[1]?e[1]:e[2],a=t<e[1]?n[1]:n[2],c=(r-a)/(o-i);return t*c+(a-i*c)}(o.referencePoints,l,n):n},convertFontSizeByTextLength:function(e,n){const t=u,o=c,r=s,a=Math.round(f(e,o.min,o.max))-o.min,l=Math.round(f(n,r.min,r.max))-r.min;return i.get(t,[a,l])}},mt={getComponentIdsAddedToDesktopStructure:ie},pt={isMobileOnlyComponentId:e=>i.includes(A,e),addComponent:B,getAdditionalStyles:()=>x()},gt={inspectStructure:ft,synchronizePages:function(e,n){return ae(e,n),i.mapValues(e,(e,t)=>(function(e,n){if(tt(e,n),ce(e,n),"masterPage"===n.id){const t=O.getChildren(n),o=O.getChildren(e);i.forEach(t,e=>i.set(e,"conversionData",i.get(i.find(o,{id:e.id}),"conversionData"))),st(t)}return oe(n),O.getChildren(n)})(e,n[t]))},mergeDesktopPagesWithMobile:function(e,n,t){return ae(e,n),i.mapValues(e,(e,o)=>lt(e,n[o],t))},mergeDesktopStructureWithMobile:lt,convertDesktopPageToMobile:function(e,n,t){return ft(e,n,t),O.isMasterPage(e)?ut(e):xn(e,d.a.MOBILE_WIDTH),ne(e,n),oe(e),O.getChildren(e)}},ht={getConversionOrder:function(e){const n=i.map(e,"id"),t=p(e,"y"),o=g(t),r=i.reduce(o,(e,t)=>{if(1===i.size(t))return[...e,...t];const o=p(t,"x"),r=g(o);return i.reduce(r,(e,t)=>{if(1===i.size(t))return[...e,...t];const o=i.sortBy(t,e=>n.indexOf(e.id));return[...e,...o]},e)},[]);return i.map(r,"id")},parseMobilePreset:function(e){const n=D(e);if(!n)return{};const t=n.components?E(n):{};return i.set(t,n.id,y(n)),t}}}])});
//# sourceMappingURL=mobileCore.js.map